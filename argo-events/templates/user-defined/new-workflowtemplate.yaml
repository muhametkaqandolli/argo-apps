# apiVersion: argoproj.io/v1alpha1
# kind: WorkflowTemplate
# metadata:
#   name: dotnet-webapp-image-new
#   namespace: argo
# spec:
#   templates:
#     - name: main            
#       dag:                      # Indicates that this is a DAG template
#         tasks:
#         - name: build-and-push-dotnet-webapp
#           template: build-dotnet-webapp 
#           arguments:
#             parameters:
#             - name: repo_url
#               value: git://github.com/muhametkaqandolli/dotnet-webapp.git
#             - name: container_image
#               value: memikaqandolli/dotnet-webapp
#             - name: container_tag
#               value: firstmanualtest
#     - name: build-dotnet-webapp
#       inputs:
#         parameters:
#           - name: repo_url
#           # - name: repo_commit_id
#           - name: container_image
#           - name: container_tag
#       container:
#         name: build-dotnet-webapp-container
#         image: gcr.io/kaniko-project/executor:debug
#         command:
#           - /kaniko/executor
#         args:
#           - '--dockerfile=/dotnet-webapp/Dockerfile'
#           - '--context={{inputs.parameters.repo_url}}'
#           - >-
#             --destination={{inputs.parameters.container_image}}:{{inputs.parameters.container_tag}}
#         volumeMounts:
#           - name: kaniko-secret
#             mountPath: /kaniko/.docker
#       volumes:
#         - name: kaniko-secret
#           secret:
#             secretName: regcred
#             items:
#               - key: .dockerconfigjson
#                 path: config.json